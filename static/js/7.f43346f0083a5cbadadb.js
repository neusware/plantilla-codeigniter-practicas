webpackJsonp([7],{"4Ttz":function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.users-list-component .filters-box[data-v-76ac74d0] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-wrap: wrap;\n      flex-wrap: wrap;\n}\n.users-list-component .filters-box .filter-item[data-v-76ac74d0] {\n    min-width: 200px;\n    max-width: 200px;\n}\n.users-list-component .filters-box .add-item[data-v-76ac74d0] {\n    margin: 10px;\n}\n@media (max-width: 768px) {\n.users-list-component .filters-box .filter-item[data-v-76ac74d0] {\n    min-width: 46%;\n}\n}\n@media (max-width: 480px) {\n.users-list-component .filters-box .filter-item[data-v-76ac74d0] {\n    -webkit-box-flex: 1;\n        -ms-flex: 1;\n            flex: 1;\n    min-width: 95%;\n    margin: 10px;\n}\n}\n",""])},YyZb:function(t,e,a){var i=a("4Ttz");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("33aa15b1",i,!0)},srIN:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("mvHQ"),n=a.n(i),o=a("pcot"),s={name:"user",mixins:[a("XsWq").a],mounted:function(){var t=this;this.$bus.$on("recargarListaUsuarios",function(){t.fetchData(t.pagination.curr_page)}),console.log("Mounted Users ejecutado"),this.fetchData(this.pagination.curr_page)},data:function(){return{loading:!0,deleting:!0,userList:[],pagination:{curr_page:1,total_pages:1,limit:10},filters:{buscador:""}}},methods:{fetchData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.loading=!0,this.deleting=!1,this.userList=[],this.pagination={curr_page:1,total_pages:1,limit:10},o.default.getFilteredUsers(this.filters,e).then(function(e){t.userList=e.data.data,t.pagination=e.data.counts,t.encodeFilters(),t.loading=!1}).catch(function(){t.loading=!1})},handleClickUser:function(t){this.encodeFilters("UsersProfile",{id_usuario:t.id})},handleEdit:function(t){var e={user:t};this.$modal.show("usuario",JSON.parse(n()(e)))},handleDelete:function(t){var e=this;this.$modal.show("dialog",{title:"Eliminar Usuario",text:"¿Seguro que quieres <b>eliminar</b> el usuario? <b>"+t.first_name+" "+t.last_name+" ("+t.username+")</b>?",buttons:[{title:"No"},{title:"Sí, borrar",default:!0,handler:function(){e.loading=!0,e.deleting=!0,o.default.delete(t.id).then(function(t){e.fetchData(1)}).catch(function(){e.loading=!1,e.deleting=!1}),e.$modal.hide("dialog")}}]})},changePagination:function(t){this.fetchData(t)},addNewUser:function(){this.$modal.show("usuario")}},watch:{$route:function(t,e){t.name!==e.name&&this.fetchData()}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"users-list-component"},[a("title-box",{attrs:{icon:t.$helpers.getRouteIcon(),title:t.$helpers.getRouteTitle()}},[t.$helpers.isAdmin()?a("add-new-thing",{attrs:{disabled:t.deleting,text:"Añadir Usuario"},on:{click:function(e){return t.$modal.show("usuario")}}}):t._e()],1),a("div",{staticClass:"filters-box"},[a("custom-input",{staticClass:"filter-item",staticStyle:{margin:"10px"},attrs:{placeholder:"Buscar Usuario..."},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.fetchData(1)}},model:{value:t.filters.buscador,callback:function(e){t.$set(t.filters,"buscador",e)},expression:"filters.buscador"}}),a("custom-button",{staticClass:"add-item",staticStyle:{"min-width":"150px"},attrs:{disabled:t.deleting},nativeOn:{click:function(e){return t.fetchData(1)}}},[t._v("Buscar")])],1),t.pagination.total_pages>1?a("div",{staticClass:"top-pagination"},[a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{layout:"prev, pager, next","page-size":t.pagination.limit,"current-page":t.pagination.curr_page,"page-count":t.pagination.total_pages},on:{"current-change":t.changePagination}})],1)]):t._e(),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"user-table custom-table",attrs:{data:t.userList,fit:"",stripe:"stripe","element-loading-text":t.deleting?"Borrando...":"Cargando..."}},[a("el-table-column",{attrs:{label:"Nombre de usuario",prop:"username","min-width":"190px"}}),a("el-table-column",{attrs:{label:"Rol","min-width":"120px","label-align":"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"column title"},t._l(e.row.grupos,function(e){return a("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(e.grupo.description))])}),0)]}}])}),a("el-table-column",{attrs:{label:"E-mail",prop:"email","min-width":"190px"}}),a("el-table-column",{attrs:{label:"Nombre",prop:"first_name","min-width":"120px"}}),a("el-table-column",{attrs:{label:"Apellidos",prop:"last_name","min-width":"120px"}}),a("el-table-column",{attrs:{label:"Teléfono",prop:"phone","min-width":"100px",align:"center"}}),a("el-table-column",{attrs:{label:"Acciones","min-width":"110px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{attrs:{effect:"light",content:"Ver Perfil",placement:"top"}},[a("svg-icon",{staticClass:"control-icon cus",attrs:{"icon-class":"icono_perfil_usuario"},nativeOn:{click:function(a){return a.preventDefault(),a.stopPropagation(),t.handleClickUser(e.row)}}})],1),a("el-tooltip",{attrs:{effect:"light",content:"Editar Usuario",placement:"top"}},[a("svg-icon",{staticClass:"control-icon cus",attrs:{"icon-class":"icono_editar"},nativeOn:{click:function(a){return a.preventDefault(),a.stopPropagation(),t.handleEdit(e.row)}}})],1),t.$helpers.getUser().id!=e.row.id?a("el-tooltip",{attrs:{effect:"light",content:"Eliminar Usuario",placement:"top-end"}},[a("svg-icon",{staticClass:"control-icon cus",attrs:{"icon-class":"icono_eliminar"},nativeOn:{click:function(a){return a.preventDefault(),a.stopPropagation(),t.handleDelete(e.row)}}})],1):t._e()]}}])})],1),t.pagination.total_pages>1?a("div",{staticClass:"bottom-pagination"},[a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{layout:"prev, pager, next","page-size":t.pagination.limit,"current-page":t.pagination.curr_page,"page-count":t.pagination.total_pages},on:{"current-change":t.changePagination}})],1)]):t._e()],1)},staticRenderFns:[]};var r=a("VU/8")(s,l,!1,function(t){a("YyZb")},"data-v-76ac74d0",null);e.default=r.exports}});